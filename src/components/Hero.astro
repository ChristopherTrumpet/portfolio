---
import HeroNavButton from "./HeroNavButton.astro";

const hireInquiry =
  "mailto:christopher.m.t.2005@gmail.com?subject=[Job%20Inquiry]%20<insert%20subject>";

const forHire = true;
---

<section class="-translate-y-14 lg:-translate-y-8">
  <div class="flex flex-col gap-4 my-24 px-4 lg:px-6">
    {
      forHire && (
        <a
          href={hireInquiry}
          class="inline-block w-fit font-bold tracking-tight hover:underline"
        >
          Currently for hire
        </a>
      )
    }
    <h1 class="text-5xl">
      <a href="/" class="font-serif tracking-tight">
        Christopher Trumpet Jr.
      </a>
      <span>
        <button
          id="play-btn"
          class="transition-all cursor-pointer hover:scale-110"
        >
          ðŸŽº
        </button>
      </span>
    </h1>
    <p class="text-zinc-600">
      I'm a software developer dedicated to writing effective, impactful
      solutions which serve to improve the lives of the people who use them both
      directly or indirectly, <em>ideally</em>.
    </p>
    <nav class="navigation">
      <ul
        class="grid grid-cols-6 grid-rows-[1fr auto 1fr 1fr 1fr] lg:grid-rows-[1fr_auto_1fr] gap-4"
      >
        <li class="col-span-3 inline-block">
          <HeroNavButton href="/">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24px"
              height="24px"
              viewBox="0 0 24 24"
            >
              <g
                fill="none"
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.25"
              >
                <path
                  d="M5 12H3l9-9l9 9h-2M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2-2v-7"
                ></path>
                <path d="M9 21v-6a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v6"></path>
              </g>
            </svg>
            home
          </HeroNavButton>
        </li>
        <li class="col-span-3 inline-block">
          <HeroNavButton href="/projects">
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24"
              height="24"
              viewBox="0 0 24 24"
            >
              <path
                fill="none"
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.25"
                d="m3.604 7.197l7.138-3.109a.96.96 0 0 1 1.27.527l4.924 11.902a1 1 0 0 1-.514 1.304L9.285 20.93a.96.96 0 0 1-1.271-.527L3.09 8.5a1 1 0 0 1 .514-1.304zM15 4h1a1 1 0 0 1 1 1v3.5M20 6q.396.168.768.315a1 1 0 0 1 .53 1.311L19 13"
              ></path>
            </svg>
            projects
          </HeroNavButton>
        </li>
        <!-- <hr class="border-zinc-300 row-start-2 col-span-full" /> -->
        <div class="flex gap-2 col-span-full items-center row-start-2">
          <hr class="grow border-zinc-300" />
          <p class="text-xs tracking-wide text-zinc-500 leading-normal">
            other pages
          </p>
          <hr class="grow border-zinc-300" />
        </div>
        <li class="row-start-3 col-span-full lg:col-span-2 inline-block">
          <HeroNavButton href="/media" disabled={false}>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24px"
              height="24px"
              viewBox="0 0 24 24"
            >
              <g
                fill="none"
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.25"
              >
                <path
                  d="M5 7h1a2 2 0 0 0 2-2a1 1 0 0 1 1-1h6a1 1 0 0 1 1 1a2 2 0 0 0 2 2h1a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V9a2 2 0 0 1 2-2"
                ></path>
                <path d="M9 13a3 3 0 1 0 6 0a3 3 0 0 0-6 0"></path>
              </g>
            </svg>
            media
          </HeroNavButton>
        </li>
        <li
          class="row-start-4 lg:row-start-3 col-span-full lg:col-span-2 inline-block"
        >
          <HeroNavButton href="/sandbox" disabled={false}>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24px"
              height="24px"
              viewBox="0 0 24 24"
            >
              <g
                fill="none"
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.25"
              >
                <path
                  d="M19.953 8.017L21 15v2a3 3 0 0 1-3 3H6a3 3 0 0 1-3-3v-2l1.245-8.297A2 2 0 0 1 6.222 5H10M3 15h18M13 3l5.5 1.5m-2.75-.75l-2 7"
                ></path>
                <path d="M7 10.5q2.5-1 5 0t5 0"></path>
              </g>
            </svg>
            sandbox
          </HeroNavButton>
        </li>
        <li
          class="row-start-5 lg:row-start-3 col-span-full lg:col-span-2 inline-block"
        >
          <HeroNavButton href="/blog" disabled={false}>
            <svg
              xmlns="http://www.w3.org/2000/svg"
              width="24px"
              height="24px"
              viewBox="0 0 24 24"
            >
              <g
                fill="none"
                stroke="currentColor"
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="1.25"
              >
                <path d="m14 6l7 7l-4 4"></path>
                <path
                  d="M5.828 18.172a2.83 2.83 0 0 0 4 0L20.414 7.586a2 2 0 0 0 0-2.829l-1.171-1.171a2 2 0 0 0-2.829 0L5.828 14.172a2.83 2.83 0 0 0 0 4M4 20l1.768-1.768"
                ></path>
              </g>
            </svg>
            blog
          </HeroNavButton>
        </li>
      </ul>
    </nav>
  </div>
</section>

<script>
  let rawAudioData: ArrayBuffer | null = null;
  let audioBuffer: AudioBuffer | null = null;
  let audioCtx: AudioContext | null = null;

  const SFX_URL = "/trumpet-sfx.mp3";

  async function preloadFile() {
    try {
      const response = await fetch(SFX_URL);
      rawAudioData = await response.arrayBuffer();
    } catch (err) {
      console.error("Failed to download audio file:", err);
    }
  }

  async function handlePlayClick() {
    if (!rawAudioData) return;

    if (!audioCtx) {
      audioCtx = new (window.AudioContext || window.AudioContext)();
    }

    if (!audioBuffer) {
      audioBuffer = await audioCtx.decodeAudioData(rawAudioData);
    }

    if (audioCtx.state === "suspended") {
      await audioCtx.resume();
    }

    const source = audioCtx.createBufferSource();
    const gainNode = audioCtx.createGain();

    source.buffer = audioBuffer;

    const pitchRange = 0.075;
    const volumeRange = 0.1;
    source.playbackRate.value = 1.0 + (Math.random() * 2 - 1) * pitchRange;
    gainNode.gain.value = 1.0 - Math.random() * volumeRange;

    source.connect(gainNode);
    gainNode.connect(audioCtx.destination);
    source.start(0);
  }

  preloadFile();

  document
    .getElementById("play-btn")
    ?.addEventListener("click", handlePlayClick);
</script>
