---
import { fetchWeatherApi } from "openmeteo";

const params = {
  latitude: 40.43329600714427,
  longitude: -86.92195322224813,
  current: ["temperature_2m", "rain", "snowfall", "cloud_cover", "is_day"],
  timezone: "auto",
  temperature_unit: "fahrenheit",
};

const url = "https://api.open-meteo.com/v1/forecast";

const responses = await fetchWeatherApi(url, params);
const response = responses[0];
const current = response.current();

const weatherData = {
  current: {
    temperature_2m: Math.round(current!.variables(0)!.value()),
    rain: current!.variables(1)!.value(),
    snowfall: current!.variables(2)!.value(),
    cloud_cover: current!.variables(3)!.value(),
    is_day: current!.variables(4)!.value(),
  },
};

let state = "";
if (weatherData.current.rain !== 0) {
  state = "Rainy";
} else if (weatherData.current.snowfall !== 0) {
  state = "Snowing";
} else if (weatherData.current.cloud_cover >= 80) {
  state = "Cloudy";
} else if (!weatherData.current.is_day) {
  state = "Night time ğŸ›ï¸";
} else {
  state = "Daytime â˜€ï¸";
}
---

<div class="flex items-center gap-2">
  <svg
    xmlns="http://www.w3.org/2000/svg"
    width="24"
    height="24"
    viewBox="0 0 24 24"
  >
    <path
      fill="none"
      stroke="currentColor"
      stroke-linecap="round"
      stroke-linejoin="round"
      stroke-width="1.25"
      d="M6.657 18C4.085 18 2 15.993 2 13.517s2.085-4.482 4.657-4.482c.393-1.762 1.794-3.2 3.675-3.773c1.88-.572 3.956-.193 5.444 1c1.488 1.19 2.162 3.007 1.77 4.769h.99c1.913 0 3.464 1.56 3.464 3.486s-1.551 3.487-3.465 3.487H6.657"
    ></path>
  </svg>
  <p class="mb-0.5">{weatherData.current.temperature_2m}&deg; {state}</p>
</div>
